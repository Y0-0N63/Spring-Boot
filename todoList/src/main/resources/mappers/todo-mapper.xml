<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- namespace : 연결헐 DAO(= Mapper 인터페이스)의 경로를 필수로 작성 *패키지 경로를 포함한 전체 이름으로 작성해야 -->
<mapper namespace="edu.kh.todo.model.mapper.TodoMapper">
	<!-- -mapper.xml 파일 생성하자마자 삭제할 것 (오류 발생)
	<cache-ref namespace=""/> -->
	
	<!-- 태그로 SQL 구문을 지정하고 작성 -->
	<!-- <select> 태그 속성
	- id : 태그를 식별하는 값으로 연결된 Mapper 인터페이스의 메서드명과 동일하게 작성해야
	- resultType : 조회 결과 한 줄을 저장하여 반환할 변수/객체 자료형을 지정
	 : 조회 결과가 여러 행이면 행 별로 변수/객체 자료형으로 저장 후 모아 리스트로 반환
	 : Mybatis에서 제공하는 Java 기본 자료형/객체 별칭 목록에 따라 String이 아닌 string으로 작성해야 -->
	<select id="testTitle" resultType = "string">
		SELECT TODO_TITLE FROM TB_TODO
		WHERE TODO_NO = 1
	</select>
	
	<!-- 할 일 목록 조회 : resultType(Todo)으로 제약된 List를 만들어서 반환 -->
	<select id="selectAll" resultType = "Todo">
		SELECT TODO_NO, TODO_TITLE, COMPLETE,
		TO_CHAR(REG_DATE, 'YYYY-MM-DD HH24:MI:SS') REG_DATE
		FROM TB_TODO
		ORDER BY TODO_NO
	</select>
	
	<select id = "getCompleteCount" resultType = "_int">
		SELECT COUNT(*)
		FROM TB_TODO
		WHERE COMPLETE = 'Y'
	</select>
	
	<!-- 할 일 추가 -->
	<!-- parameterType : 전달받은 값(전달 인자)의 타입을 명시하는 속성
		-> DTO, Map인 경우, 필드명/key를 입력해서 값/value를 하나씩 꺼내 사용할 수 있음 
		DML의 경우, resultType이 무조건 int형이므로 resultType을 무조건 생략해서 작성-->
			
	<insert id="addTodo">
		INSERT INTO TB_TODO
		VALUES(SEQ_TODO_NO.NEXTVAL, #{todoTitle}, #{todoContent}, DEFAULT, DEFAULT)
	</insert>
	
	<!-- mapper.xml 에서 java data(파라미터)를 SQL에 삽입하는 방법!
  	1) #{변수명 | 필드명} : SQL에 삽입 시 양쪽에 '' 붙여서 삽입
	   ex) MEMBER_EMAIL = #{memberEmail} -> 'member01@naver.com'
	   =============================================================
   2) ${변수명 | 필드명} : SQL에 삽입 시 양쪽에 '' 붙이지 않고 삽입				
   	${} 언제 사용할까?
  	 1) 삽입할 값이 숫자인 경우
   	 2) SQL문 자체가 변해야 하는 경우
	   ex) SELECT MEMBER_NAME, ${key} FROM "MEMBER"
   		-> ${key}가 ENROLL_DATE 인 경우
   		-> SELECT MEMBER_NAME, ENROLL_DATE FROM "MEMBER"
   		
   		-> ${key}가 MEMBER_ADDRESS 인 경우
   		-> SELECT MEMBER_NAME, MEMBER_ADDRESS FROM "MEMBER"   -->
   		
   	<!-- resultType, parameterType은 추론하여 사용 가능 > 생략 가능! -->
   	<select id = "todoDetail" resultType = "Todo">
   		SELECT TODO_NO, TODO_TITLE, TODO_CONTENT, COMPLETE,
		TO_CHAR(REG_DATE, 'YYYY-MM-DD HH24:MI:SS') REG_DATE
		FROM TB_TODO
		WHERE TODO_NO = ${todoNo}
   	</select>
   	
   	<delete id="todoDelete">
   		DELETE FROM TB_TODO
		WHERE TODO_NO = ${todoNo}
   	</delete>
</mapper>